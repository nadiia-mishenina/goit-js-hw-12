{"version":3,"file":"commonHelpers.js","sources":["../src/js/helpers.js","../src/js/render-functions.js","../src/js/pixabay-api.js","../src/main.js"],"sourcesContent":["import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nconst MESSAGES = {\n  info: `Please enter a value in the search field!`,\n  endOfSearch: `We're sorry, but you've reached the end of search results.`,\n  warning: `Sorry, there are no images matching your search query. Please try again!`,\n  error: `Sorry, there are no connection to the server. Please try again later!`,\n  exception: `Exception: We have some issue with connection. Please try again later!`,\n};\n\nconst MESSAGES_BG_COLORS = {\n  blue: '#abd4f8',\n  orange: '#f28111',\n  red: '#e97782',\n};\n\nconst EVENT_TYPE = {\n  click: 'click',\n  submit: 'submit',\n};\n\nfunction showInfoMessage(message, color) {\n  iziToast.info({\n    position: 'topRight',\n    backgroundColor: `${color}`,\n    message: `${message}`,\n  });\n}\n\nexport { EVENT_TYPE, MESSAGES, MESSAGES_BG_COLORS, showInfoMessage };\n","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst gallery = document.querySelector('.gallery');\n\nconst lightbox = new SimpleLightbox('.gallery a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\nexport function fetchGallery(data) {\n  removeLoader();\n\n  if (!data.hits || data.hits.length === 0) {\n    gallery.insertAdjacentHTML(\n      'beforeend',\n      `<p class=\"no-results\">No images found. Try another keyword!</p>`\n    );\n    return;\n  }\n\n  gallery.insertAdjacentHTML('beforeend', markupGallery(data));\n  lightbox.refresh();\n}\n\nfunction markupGallery(data) {\n  return data.hits\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => `\n      <li class=\"gallery-item hvr-grow\">\n        <a class=\"gallery-link\" href=\"${largeImageURL}\">\n          <figure class=\"gallery-figure\">\n            <img class=\"gallery-image\" src=\"${webformatURL}\" alt=\"${tags}\" loading=\"lazy\">\n            <figcaption class=\"gallery-figcaption\">\n              <ul class=\"img-content-wrapper\">\n                <li>Likes<span>${likes}</span></li>\n                <li>Views<span>${views}</span></li>\n                <li>Comments<span>${comments}</span></li>\n                <li>Downloads<span>${downloads}</span></li>\n              </ul>\n            </figcaption>\n          </figure>\n        </a>\n      </li>`\n    )\n    .join('');\n}\n\nexport function fetchLoader() {\n  // Перевіряємо, чи вже є loader, щоб не дублювати\n  if (!document.querySelector('.loader-wrapper')) {\n    gallery.insertAdjacentHTML(\n      'beforeend',\n      `<div class=\"loader-wrapper\">\n          <span class=\"loader\"></span>\n       </div>`\n    );\n  }\n}\n\nexport function removeLoader() {\n  const loader = document.querySelector('.loader-wrapper');\n  if (loader) loader.remove();\n}\n\nexport function clearGallery() {\n  gallery.innerHTML = '';\n}\n","import axios from 'axios';\nimport { MESSAGES, MESSAGES_BG_COLORS, showInfoMessage } from './helpers';\nimport { fetchLoader } from './render-functions';\n\nconst API_KEY = '52967670-3351bf06a7f07a2e608e7cced';\nconst API_URL = 'https://pixabay.com/api/';\n\nconst BASE_CONFIG = {\n  key: API_KEY,\n  image_type: 'photo',\n  orientation: 'horizontal',\n  safesearch: true,\n  per_page: 15,\n};\n\nexport async function getGalleryData(queryValue, page = 1) {\n  try {\n    fetchLoader(); // показуємо лоадер\n\n    const params = {\n      ...BASE_CONFIG,\n      q: queryValue,\n      page,\n    };\n\n    const response = await axios.get(API_URL, { params });\n\n    if (response.data.totalHits === 0) {\n      showInfoMessage(MESSAGES.noResults, MESSAGES_BG_COLORS.yellow);\n    }\n\n    return response.data;\n  } catch (error) {\n    handleAxiosError(error);\n    return null; // щоб main.js міг коректно обробити помилку\n  }\n}\n\nfunction handleAxiosError(error) {\n  if (error.response) {\n    const { data, status } = error.response;\n    showInfoMessage(\n      `${MESSAGES.exception} (Status ${status}) ERROR: ${data}`,\n      MESSAGES_BG_COLORS.orange\n    );\n  } else if (error.request) {\n    showInfoMessage(\n      `${MESSAGES.exception} No response received from server.`,\n      MESSAGES_BG_COLORS.orange\n    );\n  } else {\n    showInfoMessage(\n      `${MESSAGES.exception} ${error.message}`,\n      MESSAGES_BG_COLORS.orange\n    );\n  }\n}\n","import iziToast from 'izitoast';\nimport {\n  EVENT_TYPE,\n  MESSAGES,\n  MESSAGES_BG_COLORS,\n  showInfoMessage,\n} from './js/helpers';\nimport { getGalleryData } from './js/pixabay-api';\nimport { fetchGallery } from './js/render-functions';\n\nlet queryString = '';\nlet currentPage = 1;\nlet evtType = '';\n\nconst IMAGE_MAX_COUNT = 15;\n\nconst form = document.querySelector('.form');\nconst gallery = document.querySelector('.gallery');\nconst loadMoreBtn = document.querySelector('.load-more-btn');\nconst loaderWrapper = document.querySelector('.loader-wrapper');\n\nform.addEventListener('submit', onSubmitForm);\nloadMoreBtn.addEventListener('click', onLoadMoreClick);\n\nasync function onLoadMoreClick() {\n  try {\n    evtType = EVENT_TYPE.click;\n    await renderGallery(queryString, currentPage);\n\n    if (currentPage > 1) {\n      const firstCard = document.querySelector('.gallery li');\n      if (firstCard) {\n        const { height } = firstCard.getBoundingClientRect();\n        window.scrollBy({\n          top: height * 2,\n          left: 0,\n          behavior: 'smooth',\n        });\n      }\n    }\n  } catch (error) {\n    showInfoMessage(MESSAGES.exception + error, MESSAGES_BG_COLORS.orange);\n  }\n}\n\nasync function onSubmitForm(event) {\n  try {\n    event.preventDefault();\n    const target = event.target;\n    const search = target.elements.search.value.trim();\n\n    evtType = EVENT_TYPE.submit;\n    loadMoreBtn.classList.remove('visible');\n    iziToast.destroy();\n\n    if (queryString !== search) {\n      gallery.innerHTML = '';\n      queryString = search;\n      currentPage = 1;\n    }\n\n    if (!search) {\n      showInfoMessage(MESSAGES.info, MESSAGES_BG_COLORS.blue);\n      gallery.innerHTML = '';\n      return;\n    }\n\n    await renderGallery(queryString, currentPage);\n    target.reset();\n  } catch (error) {\n    showInfoMessage(MESSAGES.exception + error, MESSAGES_BG_COLORS.orange);\n  }\n}\n\nfunction showLoader() {\n  if (loaderWrapper) loaderWrapper.style.display = 'flex';\n}\n\nfunction hideLoader() {\n  if (loaderWrapper) loaderWrapper.style.display = 'none';\n}\n\nasync function renderGallery(searchValue, page) {\n  showLoader();\n\n  try {\n    if (searchValue === queryString && evtType === EVENT_TYPE.click) {\n      currentPage += 1;\n      page = currentPage;\n    }\n\n    const galleryData = await getGalleryData(searchValue, page);\n\n    if (validateGalleryData(galleryData)) {\n      const restOfImages = galleryData.totalHits - (page - 1) * IMAGE_MAX_COUNT;\n      fetchGallery(galleryData);\n      showHideBtn(restOfImages);\n    }\n  } catch (error) {\n    showInfoMessage(MESSAGES.exception + error, MESSAGES_BG_COLORS.orange);\n  } finally {\n    hideLoader();\n  }\n}\n\nfunction validateGalleryData(galleryData) {\n  if (!galleryData) {\n    gallery.innerHTML = '';\n    return false;\n  } else if (galleryData.totalHits === 0) {\n    showInfoMessage(MESSAGES.warning, MESSAGES_BG_COLORS.red);\n    gallery.innerHTML = '';\n    return false;\n  }\n  return true;\n}\n\nfunction showHideBtn(imagesCount) {\n  if (imagesCount <= IMAGE_MAX_COUNT) {\n    loadMoreBtn.classList.remove('visible');\n    showInfoMessage(MESSAGES.endOfSearch, MESSAGES_BG_COLORS.blue);\n  } else {\n    loadMoreBtn.classList.add('visible');\n  }\n}\n"],"names":["MESSAGES","MESSAGES_BG_COLORS","EVENT_TYPE","showInfoMessage","message","color","iziToast","gallery","lightbox","SimpleLightbox","fetchGallery","data","removeLoader","markupGallery","webformatURL","largeImageURL","tags","likes","views","comments","downloads","fetchLoader","loader","API_KEY","API_URL","BASE_CONFIG","getGalleryData","queryValue","page","params","response","axios","error","handleAxiosError","status","queryString","currentPage","evtType","IMAGE_MAX_COUNT","form","loadMoreBtn","loaderWrapper","onSubmitForm","onLoadMoreClick","renderGallery","firstCard","height","event","target","search","showLoader","hideLoader","searchValue","galleryData","validateGalleryData","restOfImages","showHideBtn","imagesCount"],"mappings":"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"}